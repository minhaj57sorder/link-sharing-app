import{Q as X}from"./QPage-33f4308b.js";import{_ as ne,a2 as H,X as K,j as g,Y as I,o as O,a as h,c as W,w as _,d as e,b as a,Z as q,a3 as E,f as w,a4 as le,a5 as $,a6 as M,a7 as Z,Q as S,u as j,a8 as D,a9 as Q,aa as re,ab as de,ac as ce,e as ue,C as me,ad as pe,m as oe,ae}from"./index-bc379ee9.js";import{b as ie,a as A}from"./axios-ac4caab3.js";import{Q as fe}from"./QFile-f7e7bcdb.js";import{u as ee,g as z}from"./userAuthStore-250486a2.js";import{u as se}from"./use-quasar-34f4ed41.js";import{e as J}from"./validationHelper-23d76de1.js";import{Q as Y}from"./QSkeleton-04d8ccba.js";import{Q as he}from"./QSelect-b3dbd957.js";import"./QItemLabel-5877a166.js";import"./selection-96bce928.js";import"./rtl-36dd996b.js";const B=N=>(re("data-v-69698a39"),N=N(),de(),N),_e={class:"flex -m-1"},ke={class:"md:w-2/5 w-full p-1 show-md-screen"},ge={class:"flex justify-center py-14"},ve={class:"phone-view relative"},ye={class:"absolute left-0 top-0 w-full h-full p-4 pl-3 pt-8 overflow-y-auto overflow-x-hidden"},we={class:"p-4"},be={class:""},xe={class:"flex justify-center mb-2"},Ne={class:"border-4 border-violet-600 rounded-full"},$e=["src"],Le=["src"],Pe={class:"text-center mb-4"},Te={class:"text-h6 p-0 m-0 font-bold"},Ue={class:"p-0 m-0 text-xs"},Ve={class:""},Se={class:"-m-1 flex flex-col"},qe={class:"w-full flex items-center justify-between"},Ee={class:"md:w-3/5 w-full p-1"},je=B(()=>e("div",null,[e("h6",{class:"text-h6"},"Profile Details"),e("p",{class:"text-p"},"Add details to create personal touch to your profile.")],-1)),Ae={class:"flex justify-between mb-6"},ze=B(()=>e("div",{class:"md:w-1/3 w-full flex items-center"},[e("span",null,"Profile Picture")],-1)),Ce={class:"md:w-1/3 w-full flex justify-center"},De={class:"relative hover-effect-image-upload"},Qe=["src"],Ie=["src"],Oe=B(()=>e("div",{class:"image-overlap absolute z-1 left-0 top-0 w-full h-full flex justify-center items-center"},[e("span",{class:"text-white"},"Upload")],-1)),Be=B(()=>e("div",{class:"md:w-1/3 w-full flex items-center p-2"},[e("span",null,"Profile Picture must be 1:1")],-1)),Fe={class:"mb-6"},Re={class:"mb-6"},Ge={class:"mb-6"},Je={key:0,class:"text-red-8 text-xs q-pl-sm"},Ye={class:"mb-6"},Me={key:0,class:"text-red-8 text-xs q-pl-sm"},Ze={__name:"EditUserProfile",setup(N){const c=se();ee();const L=H();K(),g([]);const p=g(null);g([]);const k=g({}),s=I({id:null,firstName:"",lastName:"",userName:"",email:"",password:"",profilePicture:null,permissions:[],roles:[],links:[]}),f=I({firstName:"",lastName:"",userName:"",email:"",password:"",profilePicture:"",permissions:[],roles:[]}),P=[{label:"Youtube",value:"youtube",domain:/^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/.+$/},{label:"Github",value:"github",domain:/^(https?:\/\/)?(www\.)?github\.com\/.+$/},{label:"Linkedin",value:"linkedin",domain:/^(https?:\/\/)?(www\.)?linkedin\.com\/.+$/},{label:"Facebook",value:"facebook",domain:/^(https?:\/\/)?(www\.)?facebook\.com\/.+$/},{label:"Instagram",value:"instagram",domain:/^(https?:\/\/)?(www\.)?instagram\.com\/.+$/}];function v(m){return{youtube:"mdi-youtube",github:"mdi-github",linkedin:"mdi-linkedin",facebook:"mdi-facebook",instagram:"mdi-instagram"}[m]||"mdi-web"}function V(m){return{youtube:"red-8",github:"black",linkedin:"blue-9",facebook:"blue-7",instagram:"orange-5"}[m]||"primary"}const r=async()=>{var i;if(L.params.id=="create")return;const m={method:"GET",url:"api/user/user_lists/userprofile/"+L.params.userName,headers:{Authorization:`Bearer ${z("token")}`}};try{c.loading.show();const t=await A.request(m);c.loading.hide(),s.id=t.data._id,s.firstName=t.data.firstName,f.firstName=t.data.firstName,s.lastName=t.data.lastName,f.lastName=t.data.lastName,s.userName=t.data.userName,f.userName=t.data.userName,s.email=t.data.email,f.email=t.data.email,s.password=t.data.password,f.password=t.data.password,f.profilePicture=t.data.profilePicture,s.roles=t.data.roles,f.roles=t.data.roles,s.permissions=t.data.permissions,f.permissions=t.data.permissions}catch(t){((i=t==null?void 0:t.response)==null?void 0:i.status)==401?c.notify({message:t.response.data.message+". Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):c.notify({message:t.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}),c.loading.hide(),console.error(t)}finally{}};O(()=>{r()});const T=async()=>{var i;if(L.params.id=="create")return;const m={method:"GET",url:"api/user_links/user_link_lists/userlinks/"+L.params.userName,headers:{Authorization:`Bearer ${z("token")}`}};try{c.loading.show();const t=await A.request(m);c.loading.hide(),s.links=t.data.links.map(b=>{const l=P.find(n=>n.value==b.linkType);return l?{...b,linkType:l}:b})}catch(t){((i=t==null?void 0:t.response)==null?void 0:i.status)==401?c.notify({message:t.response.data.message+". Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):c.notify({message:t.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}),c.loading.hide(),console.error(t)}};O(()=>{T()});const F=m=>{m&&m instanceof File?p.value=URL.createObjectURL(m):console.error("Invalid file input")};function R(m){return!!/^[a-zA-Z0-9]+$/.test(m)}function U(m){return m.replace(/[^a-zA-Z0-9]/g,"")}const G=async m=>{var b;m.preventDefault(),k.value={};const i={};if(s.userName&&(i.userName=s.userName,R(s.userName)||(k.value.userName="Username Not Valid. Your username should be like this "+U(s.userName))),J(s.userName)||(k.value.userName="Required feild"),s.firstName&&(i.firstName=s.firstName),s.lastName&&(i.lastName=s.lastName),s.email&&(i.email=s.email),J(s.email)||(k.value.email="Required feild"),s.password&&(i.password=s.password),J(s.password)||(k.value.password="Required feild"),s.profilePicture&&s.profilePicture.name&&s.profilePicture.lastModified&&(i.profilePicture=s.profilePicture),Object.keys(k.value).length!==0)return;if(Object.keys(i).length<=0){c.notify({message:"Empty Form Submission Not Allowed",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]});return}const t={headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${z("token")}`},data:i};t.method="post",t.url="api/user/user_lists/"+s.id;try{const l=await A.request(t);c.notify({message:"Updated Successfully!",color:"primary",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]})}catch(l){((b=l==null?void 0:l.response)==null?void 0:b.status)==401?c.notify({message:l.response.data.message+". Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):c.notify({message:l.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}),console.error(l)}};return(m,i)=>(h(),W(X,{padding:""},{default:_(()=>[e("div",_e,[e("div",ke,[a(q,{class:"bg-white",flat:""},{default:_(()=>[a(E,null,{default:_(()=>[e("div",ge,[e("div",ve,[e("div",ye,[e("div",we,[e("div",be,[e("div",xe,[e("div",Ne,[s.profilePicture?(h(),w("img",{key:0,class:"w-[5rem] rounded-full overflow-hidden",src:p.value,alt:""},null,8,$e)):(h(),w("img",{key:1,class:"w-[5rem] rounded-full overflow-hidden",src:le(ie)+"/"+f.profilePicture,alt:""},null,8,Le))])]),e("div",Pe,[e("h6",Te,$(s.firstName)+" "+$(s.lastName),1),e("p",Ue,$(s.email),1)]),e("div",Ve,[e("div",Se,[(h(!0),w(M,null,Z(s.links,t=>{var b;return h(),w("div",{class:"p-1",key:t._id},[a(S,{href:t.link,target:"_blank",class:"full-width text-left",size:"md",color:V((b=t.linkType)==null?void 0:b.value),unelevated:"","no-caps":""},{default:_(()=>{var l,n;return[e("div",qe,[a(j,{name:v((l=t.linkType)==null?void 0:l.value),size:"xs"},null,8,["name"]),e("span",null,$((n=t.linkType)==null?void 0:n.label),1),a(j,{name:"trending_flat",size:"xs"})])]}),_:2},1032,["href","color"])])}),128))])])])])])])])]),_:1})]),_:1})]),e("div",Ee,[a(q,{class:"bg-white mb-2",flat:""},{default:_(()=>[a(E,null,{default:_(()=>{var t,b,l,n;return[je,e("div",null,[e("div",Ae,[ze,e("div",Ce,[e("div",De,[s.profilePicture?(h(),w("img",{key:0,class:"w-[10rem]",src:p.value,alt:""},null,8,Qe)):(h(),w("img",{key:1,class:"w-[10rem]",src:le(ie)+"/"+f.profilePicture,alt:""},null,8,Ie)),Oe,a(fe,{class:"absolute z-10 left-0 top-0 opacity-0 w-full h-full",outlined:"",dense:"",modelValue:s.profilePicture,"onUpdate:modelValue":[i[0]||(i[0]=o=>s.profilePicture=o),F],label:"Upload Profile picture file "},{prepend:_(()=>[a(j,{name:"attach_file"})]),_:1},8,["modelValue"])])]),Be]),e("div",Fe,[a(D,{label:"First name ",type:"text",placeholder:"First name",modelValue:s.firstName,"onUpdate:modelValue":i[1]||(i[1]=o=>s.firstName=o),outlined:"",dense:""},null,8,["modelValue"])]),e("div",Re,[a(D,{label:"Last name ",type:"text",placeholder:"Last name",modelValue:s.lastName,"onUpdate:modelValue":i[2]||(i[2]=o=>s.lastName=o),outlined:"",dense:""},null,8,["modelValue"])]),e("div",Ge,[a(D,{label:"Email *",type:"email",placeholder:"name@example.com",modelValue:s.email,"onUpdate:modelValue":i[3]||(i[3]=o=>s.email=o),outlined:"",dense:""},null,8,["modelValue"]),(t=k.value)!=null&&t.email?(h(),w("div",Je,[e("span",null,$((b=k.value)==null?void 0:b.email),1)])):Q("",!0)]),e("div",Ye,[a(D,{label:"Password *",type:"text",placeholder:"Password",modelValue:s.password,"onUpdate:modelValue":i[4]||(i[4]=o=>s.password=o),outlined:"",dense:""},null,8,["modelValue"]),(l=k.value)!=null&&l.password?(h(),w("div",Me,[e("span",null,$((n=k.value)==null?void 0:n.password),1)])):Q("",!0)])])]}),_:1})]),_:1}),a(q,{class:"bg-white",flat:""},{default:_(()=>[a(E,{class:"flex justify-end"},{default:_(()=>[a(S,{label:"Save",class:"bg-primary text-white",onClick:G,"no-caps":""})]),_:1})]),_:1})])])]),_:1}))}},Xe=ne(Ze,[["__scopeId","data-v-69698a39"]]);const He=N=>(re("data-v-cb184d9e"),N=N(),de(),N),Ke={class:"flex -m-1"},We={class:"md:w-2/5 w-full p-1 show-md-screen"},es={class:"flex justify-center py-14"},ss={class:"phone-view relative"},ts={class:"absolute left-0 top-0 w-full h-full p-4 pl-3 pt-8 overflow-y-auto overflow-x-hidden"},ls={class:"p-4"},os={class:""},as={class:"flex justify-center mb-2"},is={class:"mb-2"},ns={class:"mb-2"},rs={class:"-m-1 flex flex-col"},ds={class:"w-full flex items-center justify-between"},cs={class:"md:w-3/5 w-full p-1"},us=He(()=>e("div",null,[e("h6",{class:"text-h6"},"Customize your links"),e("p",{class:"text-p"},"Add/Edit/Remove your links and then share your all profiles with world!")],-1)),ms={class:"full-width mb-2"},ps={key:0,class:"w-full"},fs=["onDragstart","onDrop"],hs={class:"w-full"},_s={class:"flex justify-between mb-2"},ks={class:"mb-2"},gs={key:0,class:"text-red-8 text-xs q-pl-sm"},vs={key:0,class:"text-red-8 text-xs q-pl-sm"},ys={__name:"EditUserLinks",setup(N){const c=se();ee();const L=H();K();const p=g([]),k=g({});g([]),g([{title:"item1"},{title:"item2"}]),g(null),g(null),g(null);const s=[{label:"Youtube",value:"youtube",domain:/^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/.+$/},{label:"Github",value:"github",domain:/^(https?:\/\/)?(www\.)?github\.com\/.+$/},{label:"Linkedin",value:"linkedin",domain:/^(https?:\/\/)?(www\.)?linkedin\.com\/.+$/},{label:"Facebook",value:"facebook",domain:/^(https?:\/\/)?(www\.)?facebook\.com\/.+$/},{label:"Instagram",value:"instagram",domain:/^(https?:\/\/)?(www\.)?instagram\.com\/.+$/}];function f(l){return{youtube:"mdi-youtube",github:"mdi-github",linkedin:"mdi-linkedin",facebook:"mdi-facebook",instagram:"mdi-instagram"}[l]||"mdi-web"}function P(l){return{youtube:"red-8",github:"black",linkedin:"blue-9",facebook:"blue-7",instagram:"orange-5"}[l]||"primary"}function v(l,n){const o=s.find(d=>d.value===n.toLowerCase());return o?o.domain.test(l):!1}const V=g([]),r=I({links:[],user:null,id:null}),T=I({links:[],user:null}),F=()=>{const l={link:"",linkType:null};r.links.push(l)},R=l=>{const n=JSON.parse(JSON.stringify(r.links));n.splice(l,1),r.links=n};let U=null;const G=l=>{U=l},m=l=>{if(U!==null){const n=r.links[U];r.links.splice(U,1),r.links.splice(l,0,n),U=null}},i=async()=>{var n;if(L.params.id=="create")return;const l={method:"GET",url:"api/user_links/user_link_lists/userlinks/"+L.params.userName,headers:{Authorization:`Bearer ${z("token")}`}};try{c.loading.show();const o=await A.request(l);c.loading.hide(),r.links=o.data.links.map(d=>{const u=s.find(y=>y.value==d.linkType);return u?{...d,linkType:u}:d}),V.value=o.data.links,T.links=o.data.links,r.user=o.data.user,r.id=o.data._id,T.user=o.data.user}catch(o){((n=o==null?void 0:o.response)==null?void 0:n.status)==401?c.notify({message:o.response.data.message+". Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):c.notify({message:o.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}),c.loading.hide(),console.error(o)}};O(()=>{i()});const t=()=>{var n,o,d,u;p.value=[];let l=!1;for(let y=0;y<r.links.length;y++){p.value.push({});const x=r.links[y];(String((n=x.linkType)==null?void 0:n.value)==null||String((o=x.linkType)==null?void 0:o.value)=="null")&&(p.value[y].linkType="Please Select A Link Type",l=!0),(x.link==null||x.link=="null"||String(x.link).trim()=="")&&(p.value[y].link="Please Enter A Link",l=!0),v(String(x.link),String((d=x.linkType)==null?void 0:d.value))||(p.value[y].link="Link is not valid for "+String((u=x.linkType)==null?void 0:u.value),l=!0)}return console.log(r.links),l},b=async l=>{var d;if(l.preventDefault(),k.value={},t())return;const n={};if(r.links&&r.links.length>0?(console.log(JSON.stringify(r.links)),n.links=JSON.stringify(r.links.map(u=>({...u,linkType:u.linkType.value})))):k.value="Atleast One link is required.",Object.keys(k.value).length!==0)return;if(Object.keys(n).length<=0){c.notify({message:"Empty Form Submission Not Allowed",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]});return}const o={headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${z("token")}`},data:n};o.method="post",o.url="api/user_links/user_link_lists/"+r.id;try{const u=await A.request(o);c.notify({message:"Updated Successfully!",color:"primary",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]})}catch(u){((d=u==null?void 0:u.response)==null?void 0:d.status)==401?c.notify({message:u.response.data.message+". Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):c.notify({message:u.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}),console.error(u)}};return(l,n)=>(h(),W(X,{padding:""},{default:_(()=>[e("div",Ke,[e("div",We,[a(q,{class:"bg-white",flat:""},{default:_(()=>[a(E,null,{default:_(()=>[e("div",es,[e("div",ss,[e("div",ts,[e("div",ls,[e("div",os,[e("div",as,[a(Y,{type:"circle",animation:"none"})]),e("div",is,[a(Y,{type:"QToolbar",animation:"none"})]),e("div",ns,[e("div",rs,[(h(!0),w(M,null,Z(r.links,o=>{var d;return h(),w("div",{class:"p-1",key:o._id},[a(S,{href:o.link,target:"_blank",class:"full-width text-left",size:"md",color:P((d=o.linkType)==null?void 0:d.value),unelevated:"","no-caps":""},{default:_(()=>{var u,y;return[e("div",ds,[a(j,{name:f((u=o.linkType)==null?void 0:u.value),size:"xs"},null,8,["name"]),e("span",null,$((y=o.linkType)==null?void 0:y.label),1),a(j,{name:"trending_flat",size:"xs"})])]}),_:2},1032,["href","color"])])}),128))])]),e("div",null,[a(Y,{type:"QToolbar",animation:"none"})])])])])])])]),_:1})]),_:1})]),e("div",cs,[a(q,{class:"bg-white mb-2",flat:""},{default:_(()=>[a(E,null,{default:_(()=>[us,e("div",ms,[a(S,{class:"full-width",label:"Add Link +",color:"primary","no-caps":"",onClick:F})]),r.links.length>0?(h(),w("div",ps,[(h(!0),w(M,null,Z(r.links,(o,d)=>{var u,y,x,te;return h(),w("div",{key:d,class:"flex justify-between items-center mb-3 draggable-item",draggable:"true",onDragstart:C=>G(d),onDragover:n[0]||(n[0]=ce(()=>{},["prevent"])),onDrop:C=>m(d)},[e("div",hs,[e("div",_s,[e("div",null,[a(j,{name:"drag_indicator",class:"drag-handle"}),ue(" Link#"+$(d+1),1)]),e("div",null,[a(S,{class:"ml-1 bg-transparent text-primary",flat:"",label:"Remove",size:"md",dense:"",onClick:()=>R(d),"no-caps":""},null,8,["onClick"])])]),e("div",null,[e("div",ks,[a(he,{label:"Select a link type *",placeholder:"Link type",modelValue:r.links[d].linkType,"onUpdate:modelValue":C=>r.links[d].linkType=C,options:s,outlined:"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),(u=p.value[d])!=null&&u.linkType?(h(),w("div",gs,[e("span",null,$((y=p.value[d])==null?void 0:y.linkType),1)])):Q("",!0)]),e("div",null,[a(D,{label:"Enter your valid link here",placeholder:"Valid Link",modelValue:r.links[d].link,"onUpdate:modelValue":C=>r.links[d].link=C,outlined:"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),(x=p.value[d])!=null&&x.link?(h(),w("div",vs,[e("span",null,$((te=p.value[d])==null?void 0:te.link),1)])):Q("",!0)])])])],40,fs)}),128))])):Q("",!0)]),_:1})]),_:1}),a(q,{class:"bg-white",flat:""},{default:_(()=>[a(E,{class:"flex justify-end"},{default:_(()=>[a(S,{label:"Save",class:"bg-primary text-white",onClick:b,"no-caps":""})]),_:1})]),_:1})])])]),_:1}))}},ws=ne(ys,[["__scopeId","data-v-cb184d9e"]]),js={__name:"UserProfile",setup(N){const c=I({sortBy:"createdAt",descending:!0,page:1,rowsPerPage:10,keywords:null,gte:null,lte:null,gtValue:null,ltValue:null,filterColumn:null,rangeColumn:null}),L=g(null),p=se();ee(),g(!1),g(null),g(!1);const k=H();K();const s=async()=>{var P;const f={method:"GET",url:"api/user/user_lists/userprofile/"+k.params.userName,headers:{Authorization:`Bearer ${z("token")}`}};p.loading.show();try{const v=await A.request(f);L.value=v.data,p.loading.hide()}catch(v){console.log(v),p.loading.hide(),((P=v==null?void 0:v.response)==null?void 0:P.status)==401?p.notify({message:v.response.data.message+", Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):p.notify({message:v.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]})}};return O(()=>{s()}),me(c,pe(s,1e3)),(f,P)=>(h(),W(X,{padding:""},{default:_(()=>{var v,V,r,T;return[oe(a(Xe,null,null,512),[[ae,((v=f.$route.query)==null?void 0:v.t)&&((V=f.$route.query)==null?void 0:V.t)=="profile-details"]]),oe(a(ws,null,null,512),[[ae,!((r=f.$route.query)!=null&&r.t&&((T=f.$route.query)==null?void 0:T.t)=="profile-details")]])]}),_:1}))}};export{js as default};
