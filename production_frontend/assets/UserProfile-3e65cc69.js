import{Q as K}from"./QPage-fca11b56.js";import{_ as ne,a5 as W,Z as X,k as y,$ as Q,o as B,a as p,c as ee,w as g,d as e,b as a,a0 as q,a6 as E,g as k,u as O,a3 as x,a7 as Z,a8 as H,Q as T,f as j,a9 as S,a4 as A,aa as re,ab as de,ac as ce,e as ue,E as me,ad as pe,p as oe,ae}from"./index-e193b915.js";import{b as ie,a as C}from"./axios-55c0125c.js";import{Q as fe}from"./QFile-0a05bf72.js";import{u as se,g as z}from"./userAuthStore-a6e63dbf.js";import{u as te}from"./use-quasar-5e1ea3bd.js";import{e as M}from"./validationHelper-953dc1de.js";import{Q as Y}from"./QSkeleton-3ee6c8ec.js";import{Q as he}from"./QSelect-4c9931a7.js";import"./QItemLabel-bdb82c54.js";import"./selection-4001ba41.js";import"./rtl-36dd996b.js";const I=N=>(re("data-v-4100fc71"),N=N(),de(),N),_e={class:"flex -m-1"},ke={class:"md:w-2/5 w-full p-1 show-md-screen"},ge={class:"flex justify-center py-14"},ve={class:"phone-view relative"},ye={class:"absolute left-0 top-0 w-full h-full p-4 pl-3 pt-8 overflow-y-auto overflow-x-hidden"},we={class:"p-4"},be={class:""},xe={class:"flex justify-center mb-2"},Ne={class:"border-4 border-violet-600 rounded-full"},$e=["src"],Le={key:1,class:"w-[5rem] h-[5rem] rounded-full overflow-hidden",src:"/images/user-placeholder.jpg",alt:""},Ue=["src"],Pe={class:"text-center mb-4"},Te={class:"text-h6 p-0 m-0 font-bold"},Ve={class:"p-0 m-0 text-xs"},Se={class:""},qe={class:"-m-1 flex flex-col"},Ee={class:"w-full flex items-center justify-between"},je={class:"md:w-3/5 w-full p-1"},Ae=I(()=>e("div",null,[e("h6",{class:"text-h6"},"Profile Details"),e("p",{class:"text-p"},"Add details to create personal touch to your profile.")],-1)),Ce={class:"flex justify-between mb-6"},ze=I(()=>e("div",{class:"md:w-1/3 w-full flex items-center"},[e("span",null,"Profile Picture")],-1)),De={class:"md:w-1/3 w-full flex justify-center"},Qe={class:"relative hover-effect-image-upload"},Ie=["src"],Oe=["src"],Be=I(()=>e("div",{class:"image-overlap absolute z-1 left-0 top-0 w-full h-full flex justify-center items-center"},[e("span",{class:"text-white"},"Upload")],-1)),Fe=I(()=>e("div",{class:"md:w-1/3 w-full flex items-center p-2"},[e("span",null,"Profile Picture must be 1:1")],-1)),Re={class:"mb-6"},Ge={class:"mb-6"},Je={class:"mb-6"},Me={key:0,class:"text-red-8 text-xs q-pl-sm"},Ye={class:"mb-6"},Ze={key:0,class:"text-red-8 text-xs q-pl-sm"},He={class:"mb-6"},Ke={key:0,class:"text-red-8 text-xs q-pl-sm"},We={key:0,class:"q-pa-none border-bottom-1"},Xe=I(()=>e("span",{style:{"padding-left":"8px"}},"Sign out",-1)),es={key:1},ss={__name:"EditUserProfile",setup(N){const u=te(),L=se(),f=W();X(),y([]);const $=y(null);y([]);const _=y({}),s=Q({id:null,firstName:"",lastName:"",userName:"",email:"",password:"",profilePicture:null,permissions:[],roles:[],links:[]}),v=Q({firstName:"",lastName:"",userName:"",email:"",password:"",profilePicture:"",permissions:[],roles:[]}),w=[{label:"Youtube",value:"youtube",domain:/^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/.+$/},{label:"Github",value:"github",domain:/^(https?:\/\/)?(www\.)?github\.com\/.+$/},{label:"Linkedin",value:"linkedin",domain:/^(https?:\/\/)?(www\.)?linkedin\.com\/.+$/},{label:"Facebook",value:"facebook",domain:/^(https?:\/\/)?(www\.)?facebook\.com\/.+$/},{label:"Instagram",value:"instagram",domain:/^(https?:\/\/)?(www\.)?instagram\.com\/.+$/}];function V(h){return{youtube:"mdi-youtube",github:"mdi-github",linkedin:"mdi-linkedin",facebook:"mdi-facebook",instagram:"mdi-instagram"}[h]||"mdi-web"}function d(h){return{youtube:"red-8",github:"black",linkedin:"blue-9",facebook:"blue-7",instagram:"orange-5"}[h]||"primary"}const U=async()=>{var n;if(f.params.id=="create")return;const h={method:"GET",url:"api/user/user_lists/userprofile/"+f.params.userName,headers:{Authorization:`Bearer ${z("token")}`}};try{u.loading.show();const t=await C.request(h);u.loading.hide(),s.id=t.data._id,s.firstName=t.data.firstName,v.firstName=t.data.firstName,s.lastName=t.data.lastName,v.lastName=t.data.lastName,s.userName=t.data.userName,v.userName=t.data.userName,s.email=t.data.email,v.email=t.data.email,s.password=t.data.password,v.password=t.data.password,v.profilePicture=t.data.profilePicture,s.roles=t.data.roles,v.roles=t.data.roles,s.permissions=t.data.permissions,v.permissions=t.data.permissions}catch(t){((n=t==null?void 0:t.response)==null?void 0:n.status)==401?u.notify({message:t.response.data.message+". Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):u.notify({message:t.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}),u.loading.hide(),console.error(t)}finally{}};B(()=>{U()});const F=async()=>{var n;if(f.params.id=="create")return;const h={method:"GET",url:"api/user_links/user_link_lists/userlinks/"+f.params.userName,headers:{Authorization:`Bearer ${z("token")}`}};try{u.loading.show();const t=await C.request(h);u.loading.hide(),s.links=t.data.links.map(i=>{const o=w.find(l=>l.value==i.linkType);return o?{...i,linkType:o}:i})}catch(t){((n=t==null?void 0:t.response)==null?void 0:n.status)==401?u.notify({message:t.response.data.message+". Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):u.notify({message:t.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}),u.loading.hide(),console.error(t)}};B(()=>{F()});const R=h=>{h&&h instanceof File?$.value=URL.createObjectURL(h):console.error("Invalid file input")};function P(h){return!!/^[a-zA-Z0-9]+$/.test(h)}function G(h){return h.replace(/[^a-zA-Z0-9]/g,"")}const J=async h=>{var i;h.preventDefault(),_.value={};const n={};if(s.userName&&(n.userName=s.userName,P(s.userName)||(_.value.userName="Username Not Valid. Your username should be like this "+G(s.userName))),M(s.userName)||(_.value.userName="Required feild"),s.firstName&&(n.firstName=s.firstName),s.lastName&&(n.lastName=s.lastName),s.email&&(n.email=s.email),M(s.email)||(_.value.email="Required feild"),s.password&&(n.password=s.password),M(s.password)||(_.value.password="Required feild"),s.profilePicture&&s.profilePicture.name&&s.profilePicture.lastModified&&(n.profilePicture=s.profilePicture),Object.keys(_.value).length!==0)return;if(Object.keys(n).length<=0){u.notify({message:"Empty Form Submission Not Allowed",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]});return}const t={headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${z("token")}`},data:n};t.method="post",t.url="api/user/user_lists/"+s.id;try{const o=await C.request(t);u.notify({message:"Updated Successfully!",color:"primary",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]})}catch(o){((i=o==null?void 0:o.response)==null?void 0:i.status)==401?u.notify({message:o.response.data.message+". Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):u.notify({message:o.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}),console.error(o)}};return(h,n)=>(p(),ee(K,{padding:""},{default:g(()=>[e("div",_e,[e("div",ke,[a(q,{class:"bg-white",flat:""},{default:g(()=>[a(E,null,{default:g(()=>[e("div",ge,[e("div",ve,[e("div",ye,[e("div",we,[e("div",be,[e("div",xe,[e("div",Ne,[s.profilePicture?(p(),k("img",{key:0,class:"w-[5rem] h-[5rem] rounded-full overflow-hidden",src:$.value,alt:""},null,8,$e)):v.profilePicture=="/images/upload-placeholder.jpg"?(p(),k("img",Le)):(p(),k("img",{key:2,class:"w-[5rem] h-[5rem] rounded-full overflow-hidden",src:O(ie)+"/"+v.profilePicture,alt:""},null,8,Ue))])]),e("div",Pe,[e("h6",Te,x(s.firstName)+" "+x(s.lastName),1),e("p",Ve,x(s.email),1)]),e("div",Se,[e("div",qe,[(p(!0),k(Z,null,H(s.links,t=>{var i;return p(),k("div",{class:"p-1",key:t._id},[a(T,{href:t.link,target:"_blank",class:"full-width text-left",size:"md",color:d((i=t.linkType)==null?void 0:i.value),unelevated:"","no-caps":""},{default:g(()=>{var o,l;return[e("div",Ee,[a(j,{name:V((o=t.linkType)==null?void 0:o.value),size:"xs"},null,8,["name"]),e("span",null,x((l=t.linkType)==null?void 0:l.label),1),a(j,{name:"trending_flat",size:"xs"})])]}),_:2},1032,["href","color"])])}),128))])])])])])])])]),_:1})]),_:1})]),e("div",je,[a(q,{class:"bg-white mb-2",flat:""},{default:g(()=>[a(E,null,{default:g(()=>{var t,i,o,l,r,m;return[Ae,e("div",null,[e("div",Ce,[ze,e("div",De,[e("div",Qe,[s.profilePicture?(p(),k("img",{key:0,class:"w-[10rem]",src:$.value,alt:""},null,8,Ie)):(p(),k("img",{key:1,class:"w-[10rem]",src:O(ie)+"/"+v.profilePicture,alt:""},null,8,Oe)),Be,a(fe,{class:"absolute z-10 left-0 top-0 opacity-0 w-full h-full",outlined:"",dense:"",modelValue:s.profilePicture,"onUpdate:modelValue":[n[0]||(n[0]=c=>s.profilePicture=c),R],label:"Upload Profile picture file "},{prepend:g(()=>[a(j,{name:"attach_file"})]),_:1},8,["modelValue"])])]),Fe]),e("div",Re,[a(S,{label:"First name ",type:"text",placeholder:"First name",modelValue:s.firstName,"onUpdate:modelValue":n[1]||(n[1]=c=>s.firstName=c),outlined:"",dense:""},null,8,["modelValue"])]),e("div",Ge,[a(S,{label:"Last name ",type:"text",placeholder:"Last name",modelValue:s.lastName,"onUpdate:modelValue":n[2]||(n[2]=c=>s.lastName=c),outlined:"",dense:""},null,8,["modelValue"])]),e("div",Je,[a(S,{label:"User name ",type:"text",placeholder:"User name",modelValue:s.userName,"onUpdate:modelValue":n[3]||(n[3]=c=>s.userName=c),outlined:"",dense:"",disable:""},null,8,["modelValue"]),(t=_.value)!=null&&t.userName?(p(),k("div",Me,[e("span",null,x((i=_.value)==null?void 0:i.userName),1)])):A("",!0)]),e("div",Ye,[a(S,{label:"Email *",type:"email",placeholder:"name@example.com",modelValue:s.email,"onUpdate:modelValue":n[4]||(n[4]=c=>s.email=c),outlined:"",dense:""},null,8,["modelValue"]),(o=_.value)!=null&&o.email?(p(),k("div",Ze,[e("span",null,x((l=_.value)==null?void 0:l.email),1)])):A("",!0)]),e("div",He,[a(S,{label:"Password *",type:"text",placeholder:"Password",modelValue:s.password,"onUpdate:modelValue":n[5]||(n[5]=c=>s.password=c),outlined:"",dense:""},null,8,["modelValue"]),(r=_.value)!=null&&r.password?(p(),k("div",Ke,[e("span",null,x((m=_.value)==null?void 0:m.password),1)])):A("",!0)])])]}),_:1})]),_:1}),a(q,{class:"bg-white",flat:""},{default:g(()=>[a(E,{class:"flex justify-between"},{default:g(()=>{var t;return[(t=O(L))!=null&&t.userData?(p(),k("div",We,[a(T,{flat:"",class:"full-width text-weight-bold bg-red text-white",align:"left","no-caps":"",icon:"logout",onClick:O(L).signOut},{default:g(()=>[Xe]),_:1},8,["onClick"])])):(p(),k("div",es)),a(T,{label:"Save",class:"bg-primary text-white",onClick:J,"no-caps":""})]}),_:1})]),_:1})])])]),_:1}))}},ts=ne(ss,[["__scopeId","data-v-4100fc71"]]);const ls=N=>(re("data-v-cb184d9e"),N=N(),de(),N),os={class:"flex -m-1"},as={class:"md:w-2/5 w-full p-1 show-md-screen"},is={class:"flex justify-center py-14"},ns={class:"phone-view relative"},rs={class:"absolute left-0 top-0 w-full h-full p-4 pl-3 pt-8 overflow-y-auto overflow-x-hidden"},ds={class:"p-4"},cs={class:""},us={class:"flex justify-center mb-2"},ms={class:"mb-2"},ps={class:"mb-2"},fs={class:"-m-1 flex flex-col"},hs={class:"w-full flex items-center justify-between"},_s={class:"md:w-3/5 w-full p-1"},ks=ls(()=>e("div",null,[e("h6",{class:"text-h6"},"Customize your links"),e("p",{class:"text-p"},"Add/Edit/Remove your links and then share your all profiles with world!")],-1)),gs={class:"full-width mb-2"},vs={key:0,class:"w-full"},ys=["onDragstart","onDrop"],ws={class:"w-full"},bs={class:"flex justify-between mb-2"},xs={class:"mb-2"},Ns={key:0,class:"text-red-8 text-xs q-pl-sm"},$s={key:0,class:"text-red-8 text-xs q-pl-sm"},Ls={__name:"EditUserLinks",setup(N){const u=te();se();const L=W();X();const f=y([]),$=y({});y([]),y([{title:"item1"},{title:"item2"}]),y(null),y(null),y(null);const _=[{label:"Youtube",value:"youtube",domain:/^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/.+$/},{label:"Github",value:"github",domain:/^(https?:\/\/)?(www\.)?github\.com\/.+$/},{label:"Linkedin",value:"linkedin",domain:/^(https?:\/\/)?(www\.)?linkedin\.com\/.+$/},{label:"Facebook",value:"facebook",domain:/^(https?:\/\/)?(www\.)?facebook\.com\/.+$/},{label:"Instagram",value:"instagram",domain:/^(https?:\/\/)?(www\.)?instagram\.com\/.+$/}];function s(i){return{youtube:"mdi-youtube",github:"mdi-github",linkedin:"mdi-linkedin",facebook:"mdi-facebook",instagram:"mdi-instagram"}[i]||"mdi-web"}function v(i){return{youtube:"red-8",github:"black",linkedin:"blue-9",facebook:"blue-7",instagram:"orange-5"}[i]||"primary"}function w(i,o){const l=_.find(r=>r.value===o.toLowerCase());return l?l.domain.test(i):!1}const V=y([]),d=Q({links:[],user:null,id:null}),U=Q({links:[],user:null}),F=()=>{const i={link:"",linkType:null};d.links.push(i)},R=i=>{const o=JSON.parse(JSON.stringify(d.links));o.splice(i,1),d.links=o};let P=null;const G=i=>{P=i},J=i=>{if(P!==null){const o=d.links[P];d.links.splice(P,1),d.links.splice(i,0,o),P=null}},h=async()=>{var o;if(L.params.id=="create")return;const i={method:"GET",url:"api/user_links/user_link_lists/userlinks/"+L.params.userName,headers:{Authorization:`Bearer ${z("token")}`}};try{u.loading.show();const l=await C.request(i);u.loading.hide(),d.links=l.data.links.map(r=>{const m=_.find(c=>c.value==r.linkType);return m?{...r,linkType:m}:r}),V.value=l.data.links,U.links=l.data.links,d.user=l.data.user,d.id=l.data._id,U.user=l.data.user}catch(l){((o=l==null?void 0:l.response)==null?void 0:o.status)==401?u.notify({message:l.response.data.message+". Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):u.notify({message:l.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}),u.loading.hide(),console.error(l)}};B(()=>{h()});const n=()=>{var o,l,r,m;f.value=[];let i=!1;for(let c=0;c<d.links.length;c++){f.value.push({});const b=d.links[c];(String((o=b.linkType)==null?void 0:o.value)==null||String((l=b.linkType)==null?void 0:l.value)=="null")&&(f.value[c].linkType="Please Select A Link Type",i=!0),(b.link==null||b.link=="null"||String(b.link).trim()=="")&&(f.value[c].link="Please Enter A Link",i=!0),w(String(b.link),String((r=b.linkType)==null?void 0:r.value))||(f.value[c].link="Link is not valid for "+String((m=b.linkType)==null?void 0:m.value),i=!0)}return console.log(d.links),i},t=async i=>{var r;if(i.preventDefault(),$.value={},n())return;const o={};if(d.links&&d.links.length>0?(console.log(JSON.stringify(d.links)),o.links=JSON.stringify(d.links.map(m=>({...m,linkType:m.linkType.value})))):$.value="Atleast One link is required.",Object.keys($.value).length!==0)return;if(Object.keys(o).length<=0){u.notify({message:"Empty Form Submission Not Allowed",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]});return}const l={headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${z("token")}`},data:o};l.method="post",l.url="api/user_links/user_link_lists/"+d.id;try{const m=await C.request(l);u.notify({message:"Updated Successfully!",color:"primary",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]})}catch(m){((r=m==null?void 0:m.response)==null?void 0:r.status)==401?u.notify({message:m.response.data.message+". Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):u.notify({message:m.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}),console.error(m)}};return(i,o)=>(p(),ee(K,{padding:""},{default:g(()=>[e("div",os,[e("div",as,[a(q,{class:"bg-white",flat:""},{default:g(()=>[a(E,null,{default:g(()=>[e("div",is,[e("div",ns,[e("div",rs,[e("div",ds,[e("div",cs,[e("div",us,[a(Y,{type:"circle",animation:"none"})]),e("div",ms,[a(Y,{type:"QToolbar",animation:"none"})]),e("div",ps,[e("div",fs,[(p(!0),k(Z,null,H(d.links,l=>{var r;return p(),k("div",{class:"p-1",key:l._id},[a(T,{href:l.link,target:"_blank",class:"full-width text-left",size:"md",color:v((r=l.linkType)==null?void 0:r.value),unelevated:"","no-caps":""},{default:g(()=>{var m,c;return[e("div",hs,[a(j,{name:s((m=l.linkType)==null?void 0:m.value),size:"xs"},null,8,["name"]),e("span",null,x((c=l.linkType)==null?void 0:c.label),1),a(j,{name:"trending_flat",size:"xs"})])]}),_:2},1032,["href","color"])])}),128))])]),e("div",null,[a(Y,{type:"QToolbar",animation:"none"})])])])])])])]),_:1})]),_:1})]),e("div",_s,[a(q,{class:"bg-white mb-2",flat:""},{default:g(()=>[a(E,null,{default:g(()=>[ks,e("div",gs,[a(T,{class:"full-width",label:"Add Link +",color:"primary","no-caps":"",onClick:F})]),d.links.length>0?(p(),k("div",vs,[(p(!0),k(Z,null,H(d.links,(l,r)=>{var m,c,b,le;return p(),k("div",{key:r,class:"flex justify-between items-center mb-3 draggable-item",draggable:"true",onDragstart:D=>G(r),onDragover:o[0]||(o[0]=ce(()=>{},["prevent"])),onDrop:D=>J(r)},[e("div",ws,[e("div",bs,[e("div",null,[a(j,{name:"drag_indicator",class:"drag-handle"}),ue(" Link#"+x(r+1),1)]),e("div",null,[a(T,{class:"ml-1 bg-transparent text-primary",flat:"",label:"Remove",size:"md",dense:"",onClick:()=>R(r),"no-caps":""},null,8,["onClick"])])]),e("div",null,[e("div",xs,[a(he,{label:"Select a link type *",placeholder:"Link type",modelValue:d.links[r].linkType,"onUpdate:modelValue":D=>d.links[r].linkType=D,options:_,outlined:"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),(m=f.value[r])!=null&&m.linkType?(p(),k("div",Ns,[e("span",null,x((c=f.value[r])==null?void 0:c.linkType),1)])):A("",!0)]),e("div",null,[a(S,{label:"Enter your valid link here",placeholder:"Valid Link",modelValue:d.links[r].link,"onUpdate:modelValue":D=>d.links[r].link=D,outlined:"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),(b=f.value[r])!=null&&b.link?(p(),k("div",$s,[e("span",null,x((le=f.value[r])==null?void 0:le.link),1)])):A("",!0)])])])],40,ys)}),128))])):A("",!0)]),_:1})]),_:1}),a(q,{class:"bg-white",flat:""},{default:g(()=>[a(E,{class:"flex justify-end"},{default:g(()=>[a(T,{label:"Save",class:"bg-primary text-white",onClick:t,"no-caps":""})]),_:1})]),_:1})])])]),_:1}))}},Us=ne(Ls,[["__scopeId","data-v-cb184d9e"]]),Is={__name:"UserProfile",setup(N){const u=Q({sortBy:"createdAt",descending:!0,page:1,rowsPerPage:10,keywords:null,gte:null,lte:null,gtValue:null,ltValue:null,filterColumn:null,rangeColumn:null}),L=y(null),f=te();se(),y(!1),y(null),y(!1);const $=W();X();const _=async()=>{var v;const s={method:"GET",url:"api/user/user_lists/userprofile/"+$.params.userName,headers:{Authorization:`Bearer ${z("token")}`}};f.loading.show();try{const w=await C.request(s);L.value=w.data,f.loading.hide()}catch(w){console.log(w),f.loading.hide(),((v=w==null?void 0:w.response)==null?void 0:v.status)==401?f.notify({message:w.response.data.message+", Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):f.notify({message:w.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]})}};return B(()=>{_()}),me(u,pe(_,1e3)),(s,v)=>(p(),ee(K,{padding:""},{default:g(()=>{var w,V,d,U;return[oe(a(ts,null,null,512),[[ae,((w=s.$route.query)==null?void 0:w.t)&&((V=s.$route.query)==null?void 0:V.t)=="profile-details"]]),oe(a(Us,null,null,512),[[ae,!((d=s.$route.query)!=null&&d.t&&((U=s.$route.query)==null?void 0:U.t)=="profile-details")]])]}),_:1}))}};export{Is as default};
