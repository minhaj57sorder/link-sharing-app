import{Q as W}from"./QPage-67432674.js";import{b as oe,a as E}from"./axios-9a08b95f.js";import{_ as ae,a5 as X,Z as ee,k as y,$ as I,o as F,a as p,c as Q,w as g,d as e,b as i,a0 as j,a6 as A,g as k,u as B,a3 as x,a7 as H,a8 as K,Q as V,f as C,a2 as q,a4 as L,a9 as ie,aa as ne,ab as re,e as de,E as ce,ac as ue}from"./index-1e792397.js";import{Q as me}from"./QFile-3635c2fe.js";import{u as se,g as z}from"./userAuthStore-449b3ae3.js";import{u as te}from"./use-quasar-8003ad54.js";import{e as Y}from"./validationHelper-953dc1de.js";import{Q as Z}from"./QSkeleton-527f3b75.js";import{Q as pe}from"./QSelect-08c35025.js";import"./QItemLabel-121541f0.js";import"./selection-c710e03f.js";import"./rtl-36dd996b.js";const O=N=>(ie("data-v-4100fc71"),N=N(),ne(),N),fe={class:"flex -m-1"},he={class:"md:w-2/5 w-full p-1 show-md-screen"},_e={class:"flex justify-center py-14"},ke={class:"phone-view relative"},ge={class:"absolute left-0 top-0 w-full h-full p-4 pl-3 pt-8 overflow-y-auto overflow-x-hidden"},ve={class:"p-4"},ye={class:""},we={class:"flex justify-center mb-2"},be={class:"border-4 border-violet-600 rounded-full"},xe=["src"],Ne={key:1,class:"w-[5rem] h-[5rem] rounded-full overflow-hidden",src:"/images/user-placeholder.jpg",alt:""},$e=["src"],Le={class:"text-center mb-4"},Ue={class:"text-h6 p-0 m-0 font-bold"},Pe={class:"p-0 m-0 text-xs"},Te={class:""},Ve={class:"-m-1 flex flex-col"},Se={class:"w-full flex items-center justify-between"},qe={class:"md:w-3/5 w-full p-1"},Ee=O(()=>e("div",null,[e("h6",{class:"text-h6"},"Profile Details"),e("p",{class:"text-p"},"Add details to create personal touch to your profile.")],-1)),je={class:"flex justify-between mb-6"},Ae=O(()=>e("div",{class:"md:w-1/3 w-full flex items-center"},[e("span",null,"Profile Picture")],-1)),Ce={class:"md:w-1/3 w-full flex justify-center"},ze={class:"relative hover-effect-image-upload"},De=["src"],Qe=["src"],Ie=O(()=>e("div",{class:"image-overlap absolute z-1 left-0 top-0 w-full h-full flex justify-center items-center"},[e("span",{class:"text-white"},"Upload")],-1)),Oe=O(()=>e("div",{class:"md:w-1/3 w-full flex items-center p-2"},[e("span",null,"Profile Picture must be 1:1")],-1)),Be={class:"mb-6"},Fe={class:"mb-6"},Re={class:"mb-6"},Ge={key:0,class:"text-red-8 text-xs q-pl-sm"},Je={class:"mb-6"},Me={key:0,class:"text-red-8 text-xs q-pl-sm"},Ye={class:"mb-6"},Ze={key:0,class:"text-red-8 text-xs q-pl-sm"},He={key:0,class:"q-pa-none border-bottom-1"},Ke=O(()=>e("span",{style:{"padding-left":"8px"}},"Sign out",-1)),We={key:1},Xe={__name:"EditUserProfile",setup(N){const u=te(),U=se(),f=X();ee(),y([]);const $=y(null);y([]);const _=y({}),s=I({id:null,firstName:"",lastName:"",userName:"",email:"",password:"",profilePicture:null,permissions:[],roles:[],links:[]}),v=I({firstName:"",lastName:"",userName:"",email:"",password:"",profilePicture:"",permissions:[],roles:[]}),w=[{label:"Youtube",value:"youtube",domain:/^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/.+$/},{label:"Github",value:"github",domain:/^(https?:\/\/)?(www\.)?github\.com\/.+$/},{label:"Linkedin",value:"linkedin",domain:/^(https?:\/\/)?(www\.)?linkedin\.com\/.+$/},{label:"Facebook",value:"facebook",domain:/^(https?:\/\/)?(www\.)?facebook\.com\/.+$/},{label:"Instagram",value:"instagram",domain:/^(https?:\/\/)?(www\.)?instagram\.com\/.+$/}];function S(h){return{youtube:"mdi-youtube",github:"mdi-github",linkedin:"mdi-linkedin",facebook:"mdi-facebook",instagram:"mdi-instagram"}[h]||"mdi-web"}function d(h){return{youtube:"red-8",github:"black",linkedin:"blue-9",facebook:"blue-7",instagram:"orange-5"}[h]||"primary"}const P=async()=>{var n;if(f.params.id=="create")return;const h={method:"GET",url:"api/user/user_lists/userprofile/"+f.params.userName,headers:{Authorization:`Bearer ${z("token")}`}};try{u.loading.show();const t=await E.request(h);u.loading.hide(),s.id=t.data._id,s.firstName=t.data.firstName,v.firstName=t.data.firstName,s.lastName=t.data.lastName,v.lastName=t.data.lastName,s.userName=t.data.userName,v.userName=t.data.userName,s.email=t.data.email,v.email=t.data.email,s.password=t.data.password,v.password=t.data.password,v.profilePicture=t.data.profilePicture,s.roles=t.data.roles,v.roles=t.data.roles,s.permissions=t.data.permissions,v.permissions=t.data.permissions}catch(t){((n=t==null?void 0:t.response)==null?void 0:n.status)==401?u.notify({message:t.response.data.message+". Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):u.notify({message:t.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}),u.loading.hide(),console.error(t)}finally{}};F(()=>{P()});const R=async()=>{var n;if(f.params.id=="create")return;const h={method:"GET",url:"api/user_links/user_link_lists/userlinks/"+f.params.userName,headers:{Authorization:`Bearer ${z("token")}`}};try{u.loading.show();const t=await E.request(h);u.loading.hide(),s.links=t.data.links.map(a=>{const o=w.find(l=>l.value==a.linkType);return o?{...a,linkType:o}:a})}catch(t){((n=t==null?void 0:t.response)==null?void 0:n.status)==401?u.notify({message:t.response.data.message+". Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):u.notify({message:t.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}),u.loading.hide(),console.error(t)}};F(()=>{R()});const G=h=>{h&&h instanceof File?$.value=URL.createObjectURL(h):console.error("Invalid file input")};function T(h){return!!/^[a-zA-Z0-9]+$/.test(h)}function J(h){return h.replace(/[^a-zA-Z0-9]/g,"")}const M=async h=>{var a;h.preventDefault(),_.value={};const n={};if(s.userName&&(n.userName=s.userName,T(s.userName)||(_.value.userName="Username Not Valid. Your username should be like this "+J(s.userName))),Y(s.userName)||(_.value.userName="Required feild"),s.firstName&&(n.firstName=s.firstName),s.lastName&&(n.lastName=s.lastName),s.email&&(n.email=s.email),Y(s.email)||(_.value.email="Required feild"),s.password&&(n.password=s.password),Y(s.password)||(_.value.password="Required feild"),s.profilePicture&&s.profilePicture.name&&s.profilePicture.lastModified&&(n.profilePicture=s.profilePicture),Object.keys(_.value).length!==0)return;if(Object.keys(n).length<=0){u.notify({message:"Empty Form Submission Not Allowed",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]});return}const t={headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${z("token")}`},data:n};t.method="post",t.url="api/user/user_lists/"+s.id;try{const o=await E.request(t);u.notify({message:"Updated Successfully!",color:"primary",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]})}catch(o){((a=o==null?void 0:o.response)==null?void 0:a.status)==401?u.notify({message:o.response.data.message+". Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):u.notify({message:o.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}),console.error(o)}};return(h,n)=>(p(),Q(W,{padding:""},{default:g(()=>[e("div",fe,[e("div",he,[i(j,{class:"bg-white",flat:""},{default:g(()=>[i(A,null,{default:g(()=>[e("div",_e,[e("div",ke,[e("div",ge,[e("div",ve,[e("div",ye,[e("div",we,[e("div",be,[s.profilePicture?(p(),k("img",{key:0,class:"w-[5rem] h-[5rem] rounded-full overflow-hidden",src:$.value,alt:""},null,8,xe)):v.profilePicture=="/images/upload-placeholder.jpg"?(p(),k("img",Ne)):(p(),k("img",{key:2,class:"w-[5rem] h-[5rem] rounded-full overflow-hidden",src:B(oe)+"/"+v.profilePicture,alt:""},null,8,$e))])]),e("div",Le,[e("h6",Ue,x(s.firstName)+" "+x(s.lastName),1),e("p",Pe,x(s.email),1)]),e("div",Te,[e("div",Ve,[(p(!0),k(H,null,K(s.links,t=>{var a;return p(),k("div",{class:"p-1",key:t._id},[i(V,{href:t.link,target:"_blank",class:"full-width text-left",size:"md",color:d((a=t.linkType)==null?void 0:a.value),unelevated:"","no-caps":""},{default:g(()=>{var o,l;return[e("div",Se,[i(C,{name:S((o=t.linkType)==null?void 0:o.value),size:"xs"},null,8,["name"]),e("span",null,x((l=t.linkType)==null?void 0:l.label),1),i(C,{name:"trending_flat",size:"xs"})])]}),_:2},1032,["href","color"])])}),128))])])])])])])])]),_:1})]),_:1})]),e("div",qe,[i(j,{class:"bg-white mb-2",flat:""},{default:g(()=>[i(A,null,{default:g(()=>{var t,a,o,l,r,m;return[Ee,e("div",null,[e("div",je,[Ae,e("div",Ce,[e("div",ze,[s.profilePicture?(p(),k("img",{key:0,class:"w-[10rem]",src:$.value,alt:""},null,8,De)):(p(),k("img",{key:1,class:"w-[10rem]",src:B(oe)+"/"+v.profilePicture,alt:""},null,8,Qe)),Ie,i(me,{class:"absolute z-10 left-0 top-0 opacity-0 w-full h-full",outlined:"",dense:"",modelValue:s.profilePicture,"onUpdate:modelValue":[n[0]||(n[0]=c=>s.profilePicture=c),G],label:"Upload Profile picture file "},{prepend:g(()=>[i(C,{name:"attach_file"})]),_:1},8,["modelValue"])])]),Oe]),e("div",Be,[i(q,{label:"First name ",type:"text",placeholder:"First name",modelValue:s.firstName,"onUpdate:modelValue":n[1]||(n[1]=c=>s.firstName=c),outlined:"",dense:""},null,8,["modelValue"])]),e("div",Fe,[i(q,{label:"Last name ",type:"text",placeholder:"Last name",modelValue:s.lastName,"onUpdate:modelValue":n[2]||(n[2]=c=>s.lastName=c),outlined:"",dense:""},null,8,["modelValue"])]),e("div",Re,[i(q,{label:"User name ",type:"text",placeholder:"User name",modelValue:s.userName,"onUpdate:modelValue":n[3]||(n[3]=c=>s.userName=c),outlined:"",dense:"",disable:""},null,8,["modelValue"]),(t=_.value)!=null&&t.userName?(p(),k("div",Ge,[e("span",null,x((a=_.value)==null?void 0:a.userName),1)])):L("",!0)]),e("div",Je,[i(q,{label:"Email *",type:"email",placeholder:"name@example.com",modelValue:s.email,"onUpdate:modelValue":n[4]||(n[4]=c=>s.email=c),outlined:"",dense:""},null,8,["modelValue"]),(o=_.value)!=null&&o.email?(p(),k("div",Me,[e("span",null,x((l=_.value)==null?void 0:l.email),1)])):L("",!0)]),e("div",Ye,[i(q,{label:"Password *",type:"text",placeholder:"Password",modelValue:s.password,"onUpdate:modelValue":n[5]||(n[5]=c=>s.password=c),outlined:"",dense:""},null,8,["modelValue"]),(r=_.value)!=null&&r.password?(p(),k("div",Ze,[e("span",null,x((m=_.value)==null?void 0:m.password),1)])):L("",!0)])])]}),_:1})]),_:1}),i(j,{class:"bg-white",flat:""},{default:g(()=>[i(A,{class:"flex justify-between"},{default:g(()=>{var t;return[(t=B(U))!=null&&t.userData?(p(),k("div",He,[i(V,{flat:"",class:"full-width text-weight-bold bg-red text-white",align:"left","no-caps":"",icon:"logout",onClick:B(U).signOut},{default:g(()=>[Ke]),_:1},8,["onClick"])])):(p(),k("div",We)),i(V,{label:"Save",class:"bg-primary text-white",onClick:M,"no-caps":""})]}),_:1})]),_:1})])])]),_:1}))}},es=ae(Xe,[["__scopeId","data-v-4100fc71"]]);const ss=N=>(ie("data-v-cb184d9e"),N=N(),ne(),N),ts={class:"flex -m-1"},ls={class:"md:w-2/5 w-full p-1 show-md-screen"},os={class:"flex justify-center py-14"},as={class:"phone-view relative"},is={class:"absolute left-0 top-0 w-full h-full p-4 pl-3 pt-8 overflow-y-auto overflow-x-hidden"},ns={class:"p-4"},rs={class:""},ds={class:"flex justify-center mb-2"},cs={class:"mb-2"},us={class:"mb-2"},ms={class:"-m-1 flex flex-col"},ps={class:"w-full flex items-center justify-between"},fs={class:"md:w-3/5 w-full p-1"},hs=ss(()=>e("div",null,[e("h6",{class:"text-h6"},"Customize your links"),e("p",{class:"text-p"},"Add/Edit/Remove your links and then share your all profiles with world!")],-1)),_s={class:"full-width mb-2"},ks={key:0,class:"w-full"},gs=["onDragstart","onDrop"],vs={class:"w-full"},ys={class:"flex justify-between mb-2"},ws={class:"mb-2"},bs={key:0,class:"text-red-8 text-xs q-pl-sm"},xs={key:0,class:"text-red-8 text-xs q-pl-sm"},Ns={__name:"EditUserLinks",setup(N){const u=te();se();const U=X();ee();const f=y([]),$=y({});y([]),y([{title:"item1"},{title:"item2"}]),y(null),y(null),y(null);const _=[{label:"Youtube",value:"youtube",domain:/^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/.+$/},{label:"Github",value:"github",domain:/^(https?:\/\/)?(www\.)?github\.com\/.+$/},{label:"Linkedin",value:"linkedin",domain:/^(https?:\/\/)?(www\.)?linkedin\.com\/.+$/},{label:"Facebook",value:"facebook",domain:/^(https?:\/\/)?(www\.)?facebook\.com\/.+$/},{label:"Instagram",value:"instagram",domain:/^(https?:\/\/)?(www\.)?instagram\.com\/.+$/}];function s(a){return{youtube:"mdi-youtube",github:"mdi-github",linkedin:"mdi-linkedin",facebook:"mdi-facebook",instagram:"mdi-instagram"}[a]||"mdi-web"}function v(a){return{youtube:"red-8",github:"black",linkedin:"blue-9",facebook:"blue-7",instagram:"orange-5"}[a]||"primary"}function w(a,o){const l=_.find(r=>r.value===o.toLowerCase());return l?l.domain.test(a):!1}const S=y([]),d=I({links:[],user:null,id:null}),P=I({links:[],user:null}),R=()=>{const a={link:"",linkType:null};d.links.push(a)},G=a=>{const o=JSON.parse(JSON.stringify(d.links));o.splice(a,1),d.links=o};let T=null;const J=a=>{T=a},M=a=>{if(T!==null){const o=d.links[T];d.links.splice(T,1),d.links.splice(a,0,o),T=null}},h=async()=>{var o;if(U.params.id=="create")return;const a={method:"GET",url:"api/user_links/user_link_lists/userlinks/"+U.params.userName,headers:{Authorization:`Bearer ${z("token")}`}};try{u.loading.show();const l=await E.request(a);u.loading.hide(),d.links=l.data.links.map(r=>{const m=_.find(c=>c.value==r.linkType);return m?{...r,linkType:m}:r}),S.value=l.data.links,P.links=l.data.links,d.user=l.data.user,d.id=l.data._id,P.user=l.data.user}catch(l){((o=l==null?void 0:l.response)==null?void 0:o.status)==401?u.notify({message:l.response.data.message+". Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):u.notify({message:l.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}),u.loading.hide(),console.error(l)}};F(()=>{h()});const n=()=>{var o,l,r,m;f.value=[];let a=!1;for(let c=0;c<d.links.length;c++){f.value.push({});const b=d.links[c];(String((o=b.linkType)==null?void 0:o.value)==null||String((l=b.linkType)==null?void 0:l.value)=="null")&&(f.value[c].linkType="Please Select A Link Type",a=!0),(b.link==null||b.link=="null"||String(b.link).trim()=="")&&(f.value[c].link="Please Enter A Link",a=!0),w(String(b.link),String((r=b.linkType)==null?void 0:r.value))||(f.value[c].link="Link is not valid for "+String((m=b.linkType)==null?void 0:m.value),a=!0)}return console.log(d.links),a},t=async a=>{var r;if(a.preventDefault(),$.value={},n())return;const o={};if(d.links&&d.links.length>0?(console.log(JSON.stringify(d.links)),o.links=JSON.stringify(d.links.map(m=>({...m,linkType:m.linkType.value})))):$.value="Atleast One link is required.",Object.keys($.value).length!==0)return;if(Object.keys(o).length<=0){u.notify({message:"Empty Form Submission Not Allowed",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]});return}const l={headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${z("token")}`},data:o};l.method="post",l.url="api/user_links/user_link_lists/"+d.id;try{const m=await E.request(l);u.notify({message:"Updated Successfully!",color:"primary",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]})}catch(m){((r=m==null?void 0:m.response)==null?void 0:r.status)==401?u.notify({message:m.response.data.message+". Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):u.notify({message:m.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}),console.error(m)}};return(a,o)=>(p(),Q(W,{padding:""},{default:g(()=>[e("div",ts,[e("div",ls,[i(j,{class:"bg-white",flat:""},{default:g(()=>[i(A,null,{default:g(()=>[e("div",os,[e("div",as,[e("div",is,[e("div",ns,[e("div",rs,[e("div",ds,[i(Z,{type:"circle",animation:"none"})]),e("div",cs,[i(Z,{type:"QToolbar",animation:"none"})]),e("div",us,[e("div",ms,[(p(!0),k(H,null,K(d.links,l=>{var r;return p(),k("div",{class:"p-1",key:l._id},[i(V,{href:l.link,target:"_blank",class:"full-width text-left",size:"md",color:v((r=l.linkType)==null?void 0:r.value),unelevated:"","no-caps":""},{default:g(()=>{var m,c;return[e("div",ps,[i(C,{name:s((m=l.linkType)==null?void 0:m.value),size:"xs"},null,8,["name"]),e("span",null,x((c=l.linkType)==null?void 0:c.label),1),i(C,{name:"trending_flat",size:"xs"})])]}),_:2},1032,["href","color"])])}),128))])]),e("div",null,[i(Z,{type:"QToolbar",animation:"none"})])])])])])])]),_:1})]),_:1})]),e("div",fs,[i(j,{class:"bg-white mb-2",flat:""},{default:g(()=>[i(A,null,{default:g(()=>[hs,e("div",_s,[i(V,{class:"full-width",label:"Add Link +",color:"primary","no-caps":"",onClick:R})]),d.links.length>0?(p(),k("div",ks,[(p(!0),k(H,null,K(d.links,(l,r)=>{var m,c,b,le;return p(),k("div",{key:r,class:"flex justify-between items-center mb-3 draggable-item",draggable:"true",onDragstart:D=>J(r),onDragover:o[0]||(o[0]=re(()=>{},["prevent"])),onDrop:D=>M(r)},[e("div",vs,[e("div",ys,[e("div",null,[i(C,{name:"drag_indicator",class:"drag-handle"}),de(" Link#"+x(r+1),1)]),e("div",null,[i(V,{class:"ml-1 bg-transparent text-primary",flat:"",label:"Remove",size:"md",dense:"",onClick:()=>G(r),"no-caps":""},null,8,["onClick"])])]),e("div",null,[e("div",ws,[i(pe,{label:"Select a link type *",placeholder:"Link type",modelValue:d.links[r].linkType,"onUpdate:modelValue":D=>d.links[r].linkType=D,options:_,outlined:"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),(m=f.value[r])!=null&&m.linkType?(p(),k("div",bs,[e("span",null,x((c=f.value[r])==null?void 0:c.linkType),1)])):L("",!0)]),e("div",null,[i(q,{label:"Enter your valid link here",placeholder:"Valid Link",modelValue:d.links[r].link,"onUpdate:modelValue":D=>d.links[r].link=D,outlined:"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),(b=f.value[r])!=null&&b.link?(p(),k("div",xs,[e("span",null,x((le=f.value[r])==null?void 0:le.link),1)])):L("",!0)])])])],40,gs)}),128))])):L("",!0)]),_:1})]),_:1}),i(j,{class:"bg-white",flat:""},{default:g(()=>[i(A,{class:"flex justify-end"},{default:g(()=>[i(V,{label:"Save",class:"bg-primary text-white",onClick:t,"no-caps":""})]),_:1})]),_:1})])])]),_:1}))}},$s=ae(Ns,[["__scopeId","data-v-cb184d9e"]]),Ds={__name:"UserProfile",setup(N){const u=I({sortBy:"createdAt",descending:!0,page:1,rowsPerPage:10,keywords:null,gte:null,lte:null,gtValue:null,ltValue:null,filterColumn:null,rangeColumn:null}),U=y(null),f=te();se(),y(!1),y(null),y(!1);const $=X();ee();const _=async()=>{var v;const s={method:"GET",url:"api/user/user_lists/userprofile/"+$.params.userName,headers:{Authorization:`Bearer ${z("token")}`}};f.loading.show();try{const w=await E.request(s);U.value=w.data,f.loading.hide()}catch(w){console.log(w),f.loading.hide(),((v=w==null?void 0:w.response)==null?void 0:v.status)==401?f.notify({message:w.response.data.message+", Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):f.notify({message:w.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]})}};return F(()=>{_()}),ce(u,ue(_,1e3)),(s,v)=>(p(),Q(W,{padding:""},{default:g(()=>{var w,S,d,P;return[(w=s.$route.query)!=null&&w.t&&((S=s.$route.query)==null?void 0:S.t)=="profile-details"?(p(),Q(es,{key:0})):L("",!0),(d=s.$route.query)!=null&&d.t&&((P=s.$route.query)==null?void 0:P.t)=="profile-details"?L("",!0):(p(),Q($s,{key:1}))]}),_:1}))}};export{Ds as default};
